(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[783],{2016:function(e,t,s){"use strict";function r(e){return[].concat(e)}function n(e){return e.startsWith(":")}function i(e){return c(e)&&("*"===e||e.length>1&&":>~.+*".includes(e.slice(0,1))||l(e))}function a(e,t){return(c(t)||"number"==typeof t)&&"--"!==e&&!n(e)&&!o(e)}function o(e){return e.startsWith("@media")}function c(e){return e+""===e}function l(e){return c(e)&&(e.startsWith("&")||n(e))}function d(e,t=""){return e.filter(Boolean).join(t)}function h(e,t){let s=0;if(0===t.length)return s.toString();for(let e=0;e<t.length;e++)s=(s<<5)-s+t.charCodeAt(e),s&=s;return`${e??"cl"}_${s.toString(36)}`}s.d(t,{S:function(){return g},cx:function(){return function e(...t){return d(t.reduce((t,s)=>(s instanceof Set?t.push(...s):"string"==typeof s?t.push(s):Array.isArray(s)?t.push(e(...s)):"object"==typeof s&&Object.entries(s).forEach(([e,s])=>{s&&t.push(e)}),t),[])," ").trim()}}});var u=class e{constructor(e,t,s,r){this.sheet=e,this.property=t,this.value=s,this.selector=r,this.property=t,this.value=s,this.joined=`${t}:${s}`;let n=this.selector.preconditions.concat(this.selector.postconditions);this.hash=this.selector.hasConditions?this.selector.scopeClassName:h(this.sheet.name,this.joined),this.key=d([this.joined,n,this.hash])}toString(){let t=m(this.selector.preconditions,{right:this.hash});return t=m(this.selector.postconditions,{left:t}),`${t} {${e.genRule(this.property,this.value)}}`}static genRule(e,t){var s,r;return s=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r="content"===e?`"${t}"`:t,`${s}:${r};`}};function m(e,{left:t="",right:s=""}={}){let r=e.reduce((e,t)=>n(t)?e+t:l(t)?e+t.slice(1):d([e,t]," "),t);return d([r,s?`.${s}`:""]," ")}var p=class e{constructor(e,t=null,{preconditions:s,postconditions:n}={}){this.sheet=e,this.preconditions=[],this.scopeClassName=null,this.scopeName=null,this.postconditions=[],this.preconditions=s?r(s):[],this.postconditions=n?r(n):[],this.setScope(t)}setScope(e){return e&&(this.scopeClassName||(this.scopeName=e,this.scopeClassName=h(this.sheet.name,e+this.sheet.count))),this}get hasConditions(){return this.preconditions.length>0||this.postconditions.length>0}addScope(t){return new e(this.sheet,t,{preconditions:this.preconditions,postconditions:this.postconditions})}addPrecondition(t){return new e(this.sheet,this.scopeClassName,{postconditions:this.postconditions,preconditions:this.preconditions.concat(t)})}addPostcondition(t){return new e(this.sheet,this.scopeClassName,{preconditions:this.preconditions,postconditions:this.postconditions.concat(t)})}createRule(e,t){return new u(this.sheet,e,t,this)}},f=class{constructor(e,t){this.name=e,this.rootNode=t,this.storedStyles={},this.storedClasses={},this.style="",this.count=0,this.id=`flairup-${e}`,this.styleTag=this.createStyleTag()}getStyle(){return this.style}append(e){var t;this.style=(t=this.style)?`${t}
${e}`:e}apply(){this.count++,this.styleTag&&(this.styleTag.innerHTML=this.style)}isApplied(){return!!this.styleTag}createStyleTag(){if("undefined"==typeof document||this.isApplied()||null===this.rootNode)return this.styleTag;let e=document.createElement("style");return e.type="text/css",e.id=this.id,(this.rootNode??document.head).appendChild(e),e}addRule(e){let t=this.storedClasses[e.key];return c(t)?t:(this.storedClasses[e.key]=e.hash,this.storedStyles[e.hash]=[e.property,e.value],this.append(e.toString()),e.hash)}};function x(e,t){for(let s in e)t(s.trim(),e[s])}function g(e,t){let s=new f(e,t);return{create:function(e){let t={};return(function e(t,s,r){let n=[];return x(s,(a,o)=>{if(i(a))return e(t,o,r.addPrecondition(a)).forEach(e=>n.push(e));n.push([a,s[a],r.addScope(a)])}),n})(s,e,new p(s)).forEach(([e,n,c])=>{(function e(t,s,n){let c=new Set;return x(s,(s,l)=>{let d=[];if(i(s))d=e(t,l,n.addPostcondition(s));else if("."===s)d=r(l);else if(o(s))d=function(t,s,r,n){t.append(r+" {");let i=e(t,s,n);return t.append("}"),i}(t,l,s,n);else if("--"===s)d=function(t,s,r){let n=new Set,i=[];if(x(s,(s,o)=>{if(a(s,o)){i.push(u.genRule(s,o));return}y(e(t,o??{},r),n)}),!r.scopeClassName)return n;if(i.length){let e=i.join(" ");t.append(`${m(r.preconditions,{right:r.scopeClassName})} {${e}}`)}return n.add(r.scopeClassName),n}(t,l,n);else if(a(s,l)){let e=n.createRule(s,l);t.addRule(e),c.add(e.hash)}return y(d,c)}),c})(s,n,c).forEach(s=>{t[e]=t[e]??new Set,t[e].add(s)})}),s.apply(),t},getStyle:s.getStyle.bind(s),isApplied:s.isApplied.bind(s)}}function y(e,t){return e.forEach(e=>t.add(e)),t}},4023:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat/[matchId]",function(){return s(9292)}])},2362:function(e,t,s){"use strict";s.d(t,{Z:function(){return m}});var r=s(5893),n=s(1163),i=s(7294),a=s(9176),o=s(5452),c=s(3633),l=s(1781),d=s(8267),h=s(5264),u=s(775);function m(){let e=(0,n.useRouter)(),[t,s]=(0,i.useState)(0);(0,i.useEffect)(()=>{let e=async()=>{try{let e=localStorage.getItem("access_token");if(!e)return;let t=await fetch("https://fightmatch-backend.onrender.com/matches",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();s(e.length)}}catch(e){console.error("Error fetching matches:",e)}};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[]);let m=[{name:"Discover",path:"/discover",icon:a.Z},{name:"Matches",path:"/matches",icon:o.Z,badge:t},{name:"Analytics",path:"/analytics",icon:c.Z},{name:"Achievements",path:"/achievements",icon:l.Z},{name:"Profile",path:"/profile",icon:d.Z},{name:"Settings",path:"/settings",icon:h.Z}];return(0,r.jsx)("nav",{className:"bg-gray-800 border-b border-red-500/20 sticky top-0 z-50",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,r.jsxs)("div",{onClick:()=>e.push("/discover"),className:"flex items-center space-x-2 cursor-pointer group",children:[(0,r.jsx)("div",{className:"text-2xl",children:"⚔️"}),(0,r.jsx)("span",{className:"text-xl font-bold text-white group-hover:text-red-500 transition",children:"FightMatch"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[m.map(t=>{let s=t.icon,n=e.pathname===t.path;return(0,r.jsxs)("button",{onClick:()=>e.push(t.path),className:"relative flex items-center space-x-2 px-4 py-2 rounded-lg transition-all duration-200 ".concat(n?"bg-red-600 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"),children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(s,{size:20}),t.badge>0&&(0,r.jsx)("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1 animate-pulse",children:t.badge>99?"99+":t.badge})]}),(0,r.jsx)("span",{className:"hidden md:inline font-medium",children:t.name})]},t.path)}),(0,r.jsxs)("button",{onClick:()=>{localStorage.removeItem("access_token"),e.push("/login")},className:"flex items-center space-x-2 px-4 py-2 rounded-lg text-gray-300 hover:bg-red-600 hover:text-white transition-all duration-200 ml-2",children:[(0,r.jsx)(u.Z,{size:20}),(0,r.jsx)("span",{className:"hidden md:inline font-medium",children:"Logout"})]})]})]})})})}},2761:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(1134).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},3603:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(1134).Z)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},2190:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(1134).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9292:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var r=s(5893),n=s(7294),i=s(1163),a=s(9828),o=s(9490),c=s(2362),l=s(2761),d=s(2190);let h=(0,s(1134).Z)("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);var u=s(3603),m=s(3048);function p(){let e=(0,i.useRouter)(),{matchId:t}=e.query,[s,p]=(0,n.useState)([]),[f,x]=(0,n.useState)(""),[g,y]=(0,n.useState)(!1),[b,v]=(0,n.useState)(null),[j,w]=(0,n.useState)(null),[N,k]=(0,n.useState)(!1),S=(0,n.useRef)(null),C=(0,n.useRef)(null),_=()=>{S.current&&S.current.scrollIntoView({behavior:"auto",block:"end"})};(0,n.useEffect)(()=>{let e=setTimeout(()=>_(),50);return()=>clearTimeout(e)},[s]),(0,n.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("access_token"),t=await fetch("https://fightmatch-backend.onrender.com/users/me",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();w(e)}}catch(e){console.error("Error fetching current user:",e)}})()},[]),(0,n.useEffect)(()=>{(async()=>{if(t)try{let e=localStorage.getItem("access_token"),s=await fetch("https://fightmatch-backend.onrender.com/users/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){let e=await s.json();v(e)}}catch(e){console.error("Error fetching other user:",e)}})()},[t]),(0,n.useEffect)(()=>{if(!t||!j)return;let e=j.id,s="chat_".concat(Math.min(e,parseInt(t)),"_").concat(Math.max(e,parseInt(t))),r=(0,a.hJ)(o.db,"conversations",s,"messages"),n=(0,a.IO)(r,(0,a.Xo)("timestamp","asc")),i=(0,a.cf)(n,e=>{let t=[];e.forEach(e=>{var s;let r=e.data();t.push({id:e.id,...r,timestamp:null===(s=r.timestamp)||void 0===s?void 0:s.toDate()})}),p(t)},e=>{console.error("Error listening to messages:",e)});return()=>i()},[t,j]);let E=async()=>{if(f.trim()&&j){y(!0);try{let e=localStorage.getItem("access_token"),s=await fetch("https://fightmatch-backend.onrender.com/messages/send",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({match_id:parseInt(t),content:f})});if(s.ok)x(""),k(!1);else{let e=await s.json();alert(e.detail||"Failed to send message")}}catch(e){console.error("Error sending message:",e),alert("Failed to send message")}finally{y(!1)}}};return j&&b?(0,r.jsxs)("div",{className:"h-screen bg-gray-900 flex flex-col overflow-hidden",children:[(0,r.jsx)(c.Z,{}),(0,r.jsx)("div",{className:"bg-gradient-to-r from-gray-800 to-gray-900 border-b border-red-500/20 shadow-xl flex-shrink-0 z-10",children:(0,r.jsx)("div",{className:"max-w-5xl mx-auto px-4 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("button",{onClick:()=>e.push("/matches"),className:"p-2 hover:bg-gray-700/50 rounded-xl transition text-gray-400 hover:text-white",children:(0,r.jsx)(l.Z,{size:24})}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-red-500 to-orange-500 rounded-xl flex items-center justify-center text-2xl shadow-lg overflow-hidden",children:(null==b?void 0:b.profile_pic)?(0,r.jsx)("img",{src:b.profile_pic.startsWith("http")?b.profile_pic:"https://fightmatch-backend.onrender.com".concat(b.profile_pic),alt:b.username,className:"w-full h-full object-cover"}):b.username.charAt(0).toUpperCase()}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-bold text-white",children:(null==b?void 0:b.username)||"User"}),(0,r.jsxs)("p",{className:"text-sm text-gray-400",children:[(null==b?void 0:b.skill_level)||"Fighter"," • ",(null==b?void 0:b.location)||"Unknown location"]})]})]})]}),(0,r.jsx)("button",{onClick:()=>e.push("/profile/view/".concat(t)),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg transition text-sm",children:"View Profile"})]})})}),(0,r.jsx)("div",{ref:C,className:"flex-1 overflow-y-auto p-4 bg-gradient-to-b from-gray-900 to-gray-950",children:(0,r.jsxs)("div",{className:"max-w-5xl mx-auto space-y-4",children:[0===s.length?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-full",children:(0,r.jsxs)("div",{className:"text-center py-16",children:[(0,r.jsx)("div",{className:"text-7xl mb-4",children:"\uD83D\uDCAC"}),(0,r.jsx)("p",{className:"text-gray-400 text-lg",children:"No messages yet"}),(0,r.jsxs)("p",{className:"text-gray-500 text-sm mt-2",children:["Start the conversation with ",b.username,"!"]})]})}):s.map(e=>{var t;let s=e.sender_id===j.id;return(0,r.jsx)("div",{className:"flex ".concat(s?"justify-end":"justify-start"),children:(0,r.jsxs)("div",{className:"flex items-end space-x-2 max-w-md ".concat(s?"flex-row-reverse space-x-reverse":""),children:[!s&&(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-gray-600 to-gray-700 flex items-center justify-center text-sm flex-shrink-0 mb-1 overflow-hidden",children:b.profile_pic?(0,r.jsx)("img",{src:b.profile_pic.startsWith("http")?b.profile_pic:"https://fightmatch-backend.onrender.com".concat(b.profile_pic),alt:b.username,className:"w-full h-full object-cover"}):e.sender_name[0].toUpperCase()}),(0,r.jsxs)("div",{className:"px-4 py-3 rounded-2xl shadow-lg ".concat(s?"bg-gradient-to-r from-red-600 to-red-700 text-white rounded-br-md":"bg-gray-800 text-gray-100 border border-gray-700/50 rounded-bl-md"),children:[(0,r.jsx)("p",{className:"break-words whitespace-pre-wrap",children:e.content}),(0,r.jsx)("p",{className:"text-xs mt-1 ".concat(s?"text-red-200":"text-gray-500"),children:null===(t=e.timestamp)||void 0===t?void 0:t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},e.id)}),(0,r.jsx)("div",{ref:S})]})}),(0,r.jsx)("div",{className:"bg-gradient-to-r from-gray-800 to-gray-900 border-t border-red-500/20 shadow-2xl flex-shrink-0",children:(0,r.jsxs)("div",{className:"max-w-5xl mx-auto px-4 py-4 relative",children:[N&&(0,r.jsxs)("div",{className:"absolute bottom-full right-4 mb-2 z-50",children:[(0,r.jsx)("button",{onClick:()=>k(!1),className:"absolute -top-2 -right-2 z-10 p-1.5 bg-red-600 hover:bg-red-700 rounded-full text-white shadow-lg",children:(0,r.jsx)(d.Z,{size:16})}),(0,r.jsx)("div",{className:"shadow-2xl rounded-2xl overflow-hidden border border-gray-700",children:(0,r.jsx)(m.ZP,{onEmojiClick:e=>{x(t=>t+e.emoji)},theme:"dark",width:320,height:350,previewConfig:{showPreview:!1},searchDisabled:!1,skinTonesDisabled:!1,emojiStyle:"native"})})]}),(0,r.jsxs)("div",{className:"flex items-end space-x-3",children:[(0,r.jsx)("button",{onClick:()=>k(!N),className:"p-3 rounded-2xl transition border ".concat(N?"bg-red-600 text-white border-red-500":"bg-gray-900 hover:bg-gray-800 text-gray-400 hover:text-white border-gray-700"),children:(0,r.jsx)(h,{size:24})}),(0,r.jsx)("div",{className:"flex-1 bg-gray-900 rounded-2xl border border-gray-700 focus-within:border-red-500 transition",children:(0,r.jsx)("textarea",{value:f,onChange:e=>x(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),E())},placeholder:"Message ".concat(b.username,"..."),rows:"1",className:"w-full px-4 py-3 bg-transparent text-white placeholder-gray-500 focus:outline-none resize-none max-h-32",style:{minHeight:"50px"}})}),(0,r.jsx)("button",{onClick:E,disabled:!f.trim()||g,className:"p-4 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 disabled:from-gray-700 disabled:to-gray-800 text-white rounded-2xl transition-all shadow-lg disabled:shadow-none hover:shadow-red-500/50 flex items-center justify-center",children:(0,r.jsx)(u.Z,{size:20})})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"Press Enter to send, Shift + Enter for new line"})]})})]}):(0,r.jsxs)("div",{className:"h-screen bg-gray-900 flex flex-col overflow-hidden",children:[(0,r.jsx)(c.Z,{}),(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-4 border-red-500 border-t-transparent mb-4"}),(0,r.jsx)("p",{className:"text-gray-400 text-xl",children:"Loading chat..."})]})})]})}},9490:function(e,t,s){"use strict";s.d(t,{db:function(){return o}});var r=s(3977),n=s(9828),i=s(6689);let a=(0,r.ZF)({apiKey:"AIzaSyBh5ET8InC-485lsXIwoeyMOpNlwHMTEB0",authDomain:"fightmatch-45bf4.firebaseapp.com",projectId:"fightmatch-45bf4",storageBucket:"fightmatch-45bf4.firebasestorage.app",messagingSenderId:"897012307107",appId:"1:897012307107:web:ccdfc963cf572a1ae05b16",measurementId:"G-WKBYC9BL4T"}),o=(0,n.ad)(a);(0,i.cF)(a)}},function(e){e.O(0,[703,307,744,888,774,179],function(){return e(e.s=4023)}),_N_E=e.O()}]);